; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
AppName=InsightSNAP
AppVerName=InsightSNAP 1.4.1
AppPublisher=itksnap.org
AppPublisherURL=http://www.itksnap.org
AppSupportURL=http://www.itksnap.org/bb
AppUpdatesURL=http://www.itksnap.org/download/snap
DefaultDirName={pf}\InsightApplications\SNAP
DefaultGroupName=InsightSNAP
AllowNoIcons=yes

[Tasks]
Name: "desktopicon"; Description: "Create a &desktop icon"; GroupDescription: "Additional icons:"
Name: "quicklaunchicon"; Description: "Create a &Quick Launch icon"; GroupDescription: "Additional icons:"; Flags: unchecked

[Files]
Source: "@SNAP_BINARY_DIR@\Release\InsightSNAP.exe"; DestDir: "{app}"; Flags: ignoreversion
Source: "@SNAP_BINARY_DIR@\ProgramData\*.*"; DestDir: "{app}\ProgramData"; Flags: ignoreversion recursesubdirs
Source: "c:\windows\system32\msvcp71.dll"; DestDir: "{app}"; Flags: ignoreversion
Source: "c:\windows\system32\msvcr71.dll"; DestDir: "{app}"; Flags: ignoreversion
Source: "@SNAP_SOURCE_DIR@\Utilities\InnoSetup\itksnap.ico"; DestDir: "{app}"; Flags: ignoreversion

; NOTE: Don't use "Flags: ignoreversion" on any shared system files

[INI]
Filename: "{app}\SNAP.url"; Section: "InternetShortcut"; Key: "URL"; String: "http://www.itksnap.org"

[InstallDelete]
; Type: filesandordirs; Name: "{userappdata}\itk.org"
Type: files; Name: "{app}\SNAPProgramDataDirectory.txt"
Type: filesandordirs; Name: "{app}\HTMLHelp"
Type: filesandordirs; Name: "{app}\Images2D"
Type: filesandordirs; Name: "{app}\Presets"

[Icons]
Name: "{group}\InsightSNAP"; Filename: "{app}\InsightSNAP.exe"; Comment: "ITK-SNAP 3D Image Segmentation Tool"; IconFilename: "{app}\itksnap.ico"
Name: "{group}\InsightSNAP on the Web"; Filename: "{app}\SNAP.url"
Name: "{group}\Uninstall InsightSNAP"; Filename: "{uninstallexe}"
Name: "{userdesktop}\InsightSNAP"; Filename: "{app}\InsightSNAP.exe"; Tasks: desktopicon
Name: "{userappdata}\Microsoft\Internet Explorer\Quick Launch\InsightSNAP"; Filename: "{app}\InsightSNAP.exe"; Tasks: quicklaunchicon

[Run]
Filename: "{app}\InsightSNAP.exe"; Description: "Launch InsightSNAP"; Flags: nowait postinstall skipifsilent

[UninstallDelete]
Type: files; Name: "{app}\SNAP.url"


